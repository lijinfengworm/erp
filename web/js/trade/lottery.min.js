$(function(){check_link.init();shares.init();$(".ul_box").find("ul").eq(0).animateTop({time:1E4,num:5});$("#postbox_hong").animateTop({time:3E3,num:1})});
var check_link={defaults:"newegg.com.cn yixun.com sfbest.com dangdang.com vip.com dianping.com vipshop.com gome.com.cn keede.com 360buy.com jd.com suning.com yougou.com amazon.com amazon.cn taobao.com tmall.com".split(" "),ajaxLoding:!1,init:function(){this.arrays={};for(var b=0;b<this.defaults.length;b++)this.arrays[this.defaults[b]]=this.defaults[b];this.bindFun()},bindFun:function(){var b=this,c=$(".inputs_fours");$(".checking").click(function(){var c=b.parseURL($(this).parent().find("input").val()).host.split(".");
b.arrays[c[1]+"."+c[2]]?($(this).parent().find(".result2").hide(),$(this).parent().find(".result").show(),$.getJSON("http://www.shihuo.cn/lottery/verification",{url:$(this).parent().find("input").val()},function(b){0==1*b.status&&$(".start_btn").find(".nums").html("<span>X</span>"+b.data.lottery_num)}),window.open("http://go.hupu.com/u?url="+encodeURIComponent($(this).parent().find("input").val()))):($(this).parent().find(".result").hide(),$(this).parent().find(".result2").show())});$(".checking").hover(function(){$(this).addClass("bgs")},
function(){$(this).removeClass("bgs")});c.find("input").focus(function(){$(this).parent().addClass("bgs");$(this).data("fouses")||($(this).val(""),$(this).data("fouses",!0))});c.find("input").blur(function(){$(this).parent().removeClass("bgs");""==$.trim($(this).val())&&($(this).val($(this).attr("data-val")),$(this).data("fouses",null))});$(".start_btn").click(function(){if(b.ajaxLoding)return!1;b.ajaxLoding=!0;b.getAnimate()});$(".start_btn").hover(function(){$(this).addClass("bgs")},function(){$(this).removeClass("bgs")});
$(".copy_btn").click(function(){b.copyToClipboard($(this).prev().val(),$(this))});$(".winning").find(".close").click(function(){$(".winning").hide();$.ui._closeMasks()});$(".yanzheng").find(".more_goods").click(function(){$(".winning").hide();$.ui._closeMasks();$(".inputs_fours").find("input").focus()})},copyToClipboard:function(b,c){if($.ui.isie){if(window.clipboardData)window.clipboardData.setData("Text",b);else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(f){return c.tips("非IE浏览器请ctrl+c复制"),
c.prev().select(),!1}var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d)return;var g=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!g)return;g.addDataFlavor("text/unicode");var a={},a=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);a.data=b;g.setTransferData("text/unicode",a,2*b.length);if(!d)return!1;d.setData(g,
null,Components.interfaces.nsIClipboard.kGlobalClipboard)}c.tips("复制成功");return!1}c.tips("非IE浏览器请ctrl+c复制");c.prev().select()},getAnimate:function(){function b(a,e){c.t=setTimeout(function(){b(d,e);f.hide();f.eq(g).show();g+=1;2<g?g=0:"";10>d&&(clearTimeout(c.t),setTimeout(function(){c.showEnd(e)},500))},a);d-=l}for(var c=this,f=$(".showAni"),d=500,g=0,a=[30,35,40],j=a.length,e,k=[],h=0;h<j;h++){var i=parseInt(a.length*Math.random());e=a[i];a[i]=a[a.length-1];a[a.length-1]=e;a.pop();k.push(e)}var l=
k[0];$.getJSON("http://www.shihuo.cn/lottery/start?token="+token,{},function(a){switch(1*a.status){case 0:return $(".start_btn").find(".nums").html("<span>X</span>"+a.data.lottery_num),b(d,$(".win")),$(".win").find(".right").html('<p class="tit">恭喜你！获得'+a.data.type+"元红包！</p>                    <p>卡号："+a.data.account+"</p>                    <p>密码："+a.data.pass+'</p>                    <div class="bottom">                         <a href="https://hongbao.alipay.com/coupon/getbyno.htm" target="_blank" class="a">去支付宝兑换</a>                         <a href="'+
a.data.url+'" target="_blank" class="b">购买心愿宝贝</a>                    </div>'),$(".win").find(".left").html("<s>¥</s>"+a.data.type),!1;case 1:c.showEnd($(".yanzheng"));break;case 2:commonLogin();break;case 3:c.showEnd($(".endlist"));break;case 4:return $(".start_btn").find(".nums").html("<span>X</span>"+a.data.lottery_num),b(d,$(".lost")),$(".lost").find(".opt-html").html('<h2>OOPS~没中~</h2>               <p class="listp">'+(0<a.data.lottery_num?"您还有<s>"+a.data.lottery_num+"次机会</s>哦~":"您已用完今天抽奖机会!")+
"</p>"),!1}c.ajaxLoding=!1})},showEnd:function(b){b.css({left:$.ui._position(b)[0],top:$.ui._position(b)[1]}).show();$.ui._showMasks();this.ajaxLoding=!1},parseURL:function(b){var c=document.createElement("a");c.href=b;for(var f=c.protocol.replace(":",""),d=c.hostname,g=c.port,a=c.search,j={},e=c.search.replace(/^\?/,"").split("&"),k=e.length,h=0,i;h<k;h++)e[h]&&(i=e[h].split("="),j[i[0]]=i[1]);return{source:b,protocol:f,host:d,port:g,query:a,params:j,file:(c.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],
hash:c.hash.replace("#",""),path:c.pathname.replace(/^([^\/])/,"/$1"),relative:(c.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:c.pathname.replace(/^\//,"").split("/")}}},shares={init:function(){this.bindFun()},bindFun:function(){var b=["sina_weibo","qq_weibo","qzone","renren"],c=$(".zhongjiang");$(".check_box");for(var f=0;f<b.length;f++)(function(c){$("."+b[c]).click(function(){var f=encodeURIComponent(document.title);$.share(b[c],{title:f,url:"http://www.shihuo.cn/huodong/lottery",pic:"http://www.shihuo.cn/images/trade/lottery/bann1.jpg"})});
$("."+b[c]).hover(function(){$(this).addClass("on")},function(){$(this).removeClass("on")})})(f);c.click(function(){shares.checkBoxshow()});$(".shop_list").find("li").hover(function(){$(this).addClass("on")},function(){$(this).removeClass("on")})},checkBoxshow:function(){var b=$(".check_box"),c="";$.getJSON("http://www.shihuo.cn/lottery/getSelfHistory",{},function(f){switch(1*f.status){case 1:return commonLogin(),!1;case 2:return $(".lost").find(".opt-html").html('<h2>OOPS~没中~</h2>               <p class="listp">'+
(0<f.data.lottery_num?"您还有<s>"+f.data.lottery_num+"次机会</s>哦~":"您已用完今天抽奖机会!")+"</p>"),check_link.showEnd($(".lost")),!1;case 3:return check_link.showEnd($(".showtips")),!1}for(var d=0;d<f.data.data.length;d++)c+='<p class="tit">恭喜你！获得'+f.data.data[d].money+"元红包！</p>                    <p>卡号："+f.data.data[d].account+"</p>                    <p>密码："+f.data.data[d].pass+' <a href="https://hongbao.alipay.com/coupon/getbyno.htm" target="_blank" class="how">如何兑换？</a></p>                    <div class="borders"></div>';
b.find(".bottom").html('<a href="https://hongbao.alipay.com/coupon/getbyno.htm" target="_blank" class="a">去支付宝兑换</a><a href="'+f.data.url+'" target="_blank" class="b">去买心愿宝贝</a>');b.find(".right").html(c);3<b.find(".right").find(".borders").length&&b.find(".right").css({height:410,overflow:"auto",position:"relative",fontSize:16});b.css({left:$.ui._position(b)[0],top:$.ui._position(b)[1]}).show();$.ui._showMasks()})}};
(function(b,c,f){b.ui=b.ui||{};b.extend(b.ui,{_showMasks:function(a){var c="<div class='body-mask' style='position:absolute; top:0; left:0; width:100%; height:"+b(document).height()+"px; background-color:#000;  z-index:980;'></div>";b("body").append(c);b(".body-mask").css("opacity",0);b(".body-mask").animate({opacity:a?a:"0.8"})},_closeMasks:function(){var a=b(".body-mask");a.fadeOut(function(){a.remove()})},_getpageSize:function(){var a=c.documentElement;return[f.innerWidth||self.innerWidth||a&&
a.clientWidth||c.body.clientWidth,f.innerHeight||self.innerHeight||a&&a.clientHeight||c.body.clientHeight]},_getpageScroll:function(){var a;self.pageYOffset?a=self.pageYOffset:c.documentElement&&c.documentElement.scrollTop?a=c.documentElement.scrollTop:c.body&&(a=c.body.scrollTop);return a},_position:function(a){var c=(this._getpageSize()[0]-parseInt(a.outerWidth()))/2,a=(this._getpageSize()[1]-parseInt(a.outerHeight()))/2+b.ui._getpageScroll();return[c,a]},_offset:function(a){var c=a.offset().left,
a=1.6>=jQuery.fn.jquery?b.browser.msie&&6>=parseInt(b.browser.version)?a.offset().top+b.ui._getpageScroll():a.offset().top:a.offset().top;return[c,a]},isie:!!b.browser.msie,isie6:!!b.browser.msie&&6>=parseInt(b.browser.version)});var d={defaults:{sina_weibo:"http://v.t.sina.com.cn/share/share.php?appkey=2175967801&",qq_weibo:"http://v.t.qq.com/share/share.php/?appkey=2175967801&",douban:"http://www.douban.com/recommend/?",qzone:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?",kaixin:"http://www.kaixin001.com/repaste/share.php?",
renren:"http://widget.renren.com/dialog/share?"},init:function(){var a=d,b;a.url=a.defaults[arguments[0]?arguments[0]:"sina_weibo"];this.num=0;for(b in arguments[1])a.url+=(0==this.num?"":"&")+b+"="+arguments[1][b],this.num++;a.window_open(arguments[0])},window_open:function(){window.open(this.url,"分享到",this.getParamsOfShare([600,560]))},getParamsOfShare:function(a){return["toolbar=0,status=0,resizable=1,width="+a[0]+",height="+a[1]+",left=",(screen.width-a[0])/2,",top=",(screen.height-a[1])/2].join("")}},
g={defaults:{time:3E3,num:5},init:function(a){var c=g;args=a;return this.each(function(){this.opt=b.extend(!0,{},c.defaults,args||{});this.opt.tops=b(this).children().eq(0).outerHeight();c.aniMates(this)})},aniMates:function(a){setInterval(function(){b(a).animate({top:-a.opt.tops*a.opt.num},800,function(){for(var c=0;c<a.opt.num;c++)b(a).children().eq(0).appendTo(b(a));b(a).css("top",0)})},a.opt.time)}};b.fn.extend({tips:function(a,c){return this.each(function(){var e=b(this),f='<div class="tips_layer" style="position: absolute; border-radius:5px; background-color:#ff6600; display:none; z-index:995">                  <div class="tips-text" style="padding:5px; color:#fff;">'+
a+'</div>                  <div class="diamond"></div>              </div>';b(".tips_layer")&&b(".tips_layer").remove();b(f).appendTo("body");b(".tips-text");var d=b(".tips_layer");c&&2==c.length?d.css({top:e.offset().top-parseInt(e.height())-5+c[0],left:e.offset().left+c[1]}).show():d.css({top:e.offset().top-parseInt(e.height())-5,left:e.offset().left-(d.width()/2-e.width()/2)}).show();setTimeout(function(){d.remove()},1500)})},animateTop:g.init});b.extend({share:d.init,cookie:function(a,c,e){if("undefined"!=
typeof c){e=e||{};null===c&&(c="",e.expires=-1);var d="";if(e.expires&&("number"==typeof e.expires||e.expires.toUTCString))"number"==typeof e.expires?(d=new Date,d.setTime(d.getTime()+864E5*e.expires)):d=e.expires,d="; expires="+d.toUTCString();var f=e.path?"; path="+e.path:"",g=e.domain?"; domain="+e.domain:"",e=e.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(c),d,f,g,e].join("")}else{c=null;if(document.cookie&&""!=document.cookie){e=document.cookie.split(";");for(d=0;d<e.length;d++)if(f=
b.trim(e[d]),f.substring(0,a.length+1)==a+"="){c=decodeURIComponent(f.substring(a.length+1));break}}return c}}})})(jQuery,document,window);
