$(function(){"undefined"!==typeof crawler_flag&&!crawler_flag&&pubu.init()});
var pubu={itemsNum:0,init:function(){$(".goods_list").Mymasonry({itemClass:".list",resize:{isAnimated:!0,speed:800,easing:"easeInOutCubic"},css:{left:20,top:15},animateOptions:{animate:"fade",speed:800,easing:"easeInOutCubic"}});this.getScroll()},getScroll:function(){var d=this,b,e=$(".goods_list");$(window).scroll(function(){if($(document).height()<=screen.height)return!1;b=parseFloat($(window).height())+parseFloat($(window).scrollTop())+200;$(document).height()<=b&&(d.t?clearTimeout(d.t):"",d.t=
setTimeout(function(){d.getjsongHtml()},30))});e.delegate(".btn","mousemove",function(){$(this).addClass("hover")});e.delegate(".btn","mouseout",function(){$(this).removeClass("hover")});e.delegate(".btn","click",function(){d.getjsongNum($(this))});e.delegate(".imgs","mousemove",function(){$(this).parent().find(".edit").show();$(this).parent().find(".btn").show();$(this).parent().find(".recommend").show()});e.delegate(".imgs","mouseout",function(){var a=$(this);d.hov=setTimeout(function(){a.parent().find(".edit").hide();
a.parent().find(".btn").hide();a.parent().find(".recommend").hide()},100)});e.delegate(".btn","mousemove",function(){clearTimeout(d.hov);$(this).show();$(this).parent().find(".edit").show()});e.delegate(".edit","mousemove",function(){clearTimeout(d.hov);$(this).show();$(this).parent().find(".btn").show()});e.delegate(".recommend","mousemove",function(){clearTimeout(d.hov);$(this).show();$(this).parent().find(".recommend").show()})},getjsongHtml:function(){var d="",b=items,e=this.itemsNum+12;if(this.itemsNum>
b.length)return!1;for(var a=this.itemsNum;a<e;a++){var h="";if(a>=b.length)break;var h=b[a].shoe_id?"/shihuo/admin?shoe_id="+b[a].shoe_id+"&item_all_id="+b[a].id+"&baoliao_id="+b[a].baoliao_id+"&title="+encodeURI(b[a].title)+"&name="+encodeURI(b[a].name)+"&mart="+encodeURI(b[a].mart)+"&url="+encodeURI(b[a].go_url)+"&memo="+encodeURI(b[a].memo)+"&from=find":"/shihuo/admin?item_all_id="+b[a].id+"&baoliao_id="+b[a].baoliao_id+"&title="+encodeURI(b[a].title)+"&name="+encodeURI(b[a].name)+"&mart="+encodeURI(b[a].mart)+
"&url="+encodeURI(b[a].go_url)+"&memo="+encodeURI(b[a].memo)+"&from=find",f=b[a].is_taobao?"":'rel="nofollow"',d=d+('<div class="list" shoe_id="'+(b[a].shoe_id?b[a].shoe_id:0)+'" all_id ="'+b[a].id+'">          '+(hasCredential?'<div class="recommend">'+(1==b[a].is_recommend?"已推荐到首页":'<a href="'+h+'" target="_blank">推荐到首页</a>')+'</div><div class="edit"><a href="'+b[a].edit_url+'" target="_blank">编辑</a></div>':"")+(!hasCredential&&recommendlimit?'<div class="recommend">'+(1==b[a].is_recommend?"已推荐到首页":
'<a href="'+h+'" target="_blank">推荐到首页</a>')+"</div>":"")+'          <div class="imgs" style="height:'+b[a].height+'px">            <a '+f+' href="'+(b[a].is_taobao?b[a].detail_url:b[a].url)+'" target="_blank"><img src="http://shihuo.hupucdn.com'+b[a].img_url+'-S253.jpg" width="208" height="'+b[a].height+'" /></a>            <div class="btn">              <span class="wuxing"></span><span class="num">'+(0==b[a].like_count?"收藏":b[a].like_count)+'</span>            </div>          </div>          <h2 class="title">'+
(1==b[a].is_hot?'<font color="red">【热】</font>':"")+'<a href="'+b[a].detail_url+'" target="_blank">'+b[a].title+'</a> <span class="num">￥'+b[a].price+'</span></h2>          <p class="tips">'+(b[a].hupu_username?"<b>"+b[a].hupu_username+"：</b>":"")+b[a].memo+'</p>                  <div class="buy_box">                    <span class="time"><a ref="nofollow" href="'+b[a].detail_url+'" target="_blank">'+b[a].publish_date+"</a></span><a "+f+' href="'+(b[a].is_taobao?b[a].detail_url:b[a].url)+'" target="_blank" class="buy">去购买 ></a>                </div>        </div>')}this.itemsNum+=
12;$(".goods_list").Mymasonry({dom:d},"addDom")},getjsongNum:function(d){var b=d.offset().top-10,e=d.offset().left+20,a,h=d.parents(".list").attr("shoe_id"),f=d.parents(".list").attr("all_id"),c='<div class="addnum" style="color:#fff; position: absolute; font-size:14px; color:#ffba00; left:'+e+"px; top:"+b+'px;">+1</div>',m='<div class="addnum" style="color:#fff; position: absolute; font-size:14px; color:#ffba00; left:'+(e-50)+"px; top:"+b+'px;"></div>';if(!user_id)return commonLogin(),!1;0<h?e="shoe":
(e="all",h=f);$.post(addlikeUrl,{like_type:e,id:h},function(f){f=eval("("+f+")");if(f.status*1==1){$(d).addClass("hover2");$(c).appendTo("body");a=$(".addnum");a.animate({top:b-10},function(){setTimeout(function(){a.remove()},1E3)});$(d).find(".num").html(f.count)}else{$(m).appendTo("body");a=$(".addnum");a.html(f.message).animate({top:b-10},function(){setTimeout(function(){a.remove()},1E3)})}})}};
(function(d,b,e){var a={defaults:{itemClass:".list",css:{left:0,top:0},animateOptions:{animate:!1,speed:500,easing:"easeInOutCubic"}},init:function(){var h=a,f=arguments;return this.each(function(){var c=this;c.defaults=d.extend(!0,{},h.defaults,f[0]||{});c.defaults.allWidth=d(c).outerWidth();d(c).css({position:"relative"});"addDom"==f[1]?(c.defaults=d.extend(!0,{},d(c).data("defaults"),f[0]||{}),h.addDom(c)):(d(c).data("defaults",c.defaults),d(c).find(c.defaults.itemClass).hide(),d(c).imagesLoaded(function(){}),
c.defaults.bindFun&&c.defaults.bindFun(),c.defaults.resize?(d(b).resize(function(){d(c).find(c.defaults.itemClass).removeClass("mymasonry");h.postLeft([c,0,!0])}),h.postLeft([c,0,!0,"init"])):h.postLeft([c,0]))})},postLeft:function(h){var f=h[0],c=d(f).find(f.defaults.itemClass),a=0,b=h[1],e=f.defaults.animateOptions,g,i;h[2]?(this._getpageSize()[0]<f.defaults.allWidth+d(f).offset().left?g=this._getpageSize()[0]-d(f).offset().left:g=f.defaults.allWidth,f.defaults.listNum=parseInt(g/(c.eq(0).outerWidth()+
f.defaults.css.left))):f.defaults.listNum=parseInt(f.defaults.allWidth/(c.eq(0).outerWidth()+f.defaults.css.left));for(c.css({position:"absolute"});b<c.length;)if(!c.eq(b).hasClass("mymasonry")){if(b<f.defaults.listNum)g=(c.outerWidth()+f.defaults.css.left)*a,i=0+f.defaults.css.top,c.eq(b).data("list",b);else{var k;k=this.postTop(f,b);g=k[1];i=k[0]+f.defaults.css.top;c.eq(b).data("list",k[2])}if(h[2]&&!h[3])f.defaults.resize.isAnimated?(c.eq(b).data("style",{left:g,top:i}),c.eq(b).show().stop(!0).animate({left:g,
top:i},f.defaults.resize.speed,"easeInOutCubic")):c.eq(b).show().css({left:g,top:i});else if(e.animate)switch(c.eq(b).data("style",{left:g,top:i}),k=function(f,h){c.eq(b).addClass("mymasonry").css(f);c.eq(b).show().stop(true).animate(h,e.speed)},e.animate?e.animate:"fade"){case "fade":this.isie6?k({left:g,top:i},{opacity:1}):k({left:g,top:i,opacity:0},{opacity:1});break;case "right_bottom":k({left:g+30,top:i+30},{left:g,top:i});break;case "bottom":k({left:g,top:i+100},{left:g,top:i});break;default:k({left:g,
top:i,opacity:0},{opacity:1})}else c.eq(b).addClass("mymasonry").css({left:g,top:i}).show();a==f.defaults.listNum-1?a=0:a++;b++}d(f).height(this.getHeight(c))},postTop:function(b,f){var c=d(b).find(b.defaults.itemClass),a=0;for(b.defaults.postArr=[];a<b.defaults.listNum;a++){b.defaults.postArr[a]=[0,0];for(var j=0;j<f;j++)1*c.eq(j).data("list")==a&&(b.defaults.postArr[a]=[b.defaults.postArr[a][0]+=c.eq(j).outerHeight()+b.defaults.css.top,!c.eq(a).data("style")?b.defaults.postArr[a][1]=c.eq(j).position().left:
c.eq(a).data("style").left])}for(var c=b.defaults.postArr,a=c[0][0],e=j=0;e<c.length;e++){var g=e;c[g][0]<a&&(a=c[g][0],j=g)}return[c[j][0],c[j][1],j]},getHeight:function(b){for(var f=b.length,a=0,d=0,e;a<f;a++)e=b.eq(a).outerHeight()+(b.eq(a).data("style")?b.eq(a).data("style").top:b.eq(a).position().top),e>d&&(d=e);return d},addDom:function(b){var a=this,c=d(b).find(b.defaults.itemClass).length;0==d(".loding_img").length&&(d(b).append('<div class="loding_img" style="left:'+(d(b).width()/2-25)+'px"></div>'),
d(b).append(b.defaults.dom),d(b).find(b.defaults.itemClass).not(d(".mymasonry")).imagesLoaded(function(){d(".loding_img").remove();b.defaults.resize?a.postLeft([b,c,!0,"addDom"]):a.postLeft([b,c])}))},_getpageSize:function(){var a=e.documentElement;return[b.innerWidth||self.innerWidth||a&&a.clientWidth||e.body.clientWidth,b.innerHeight||self.innerHeight||a&&a.clientHeight||e.body.clientHeight]},isie:!!d.browser.msie,isie6:!!d.browser.msie&&8>=parseInt(d.browser.version)};d.fn.extend({imagesLoaded:function(b){function a(){b.call(j,
l)}function c(b){b=b.target;b.src!==i&&-1===e.inArray(b,k)&&(k.push(b),0>=--g&&(setTimeout(a),l.unbind(".imagesLoaded",c)))}var e=d,j=this,l=j.find("img").add(j.filter("img")),g=l.length,i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",k=[];return g||a(),l.bind("load.imagesLoaded error.imagesLoaded",c).each(function(){var b=this.src;this.src=i;this.src=b}),j},Mymasonry:function(){var b=arguments[0];if(a[b])b=a[b],arguments=Array.prototype.slice.call(arguments,1);else if("object"==
typeof b||!b)b=a.init;else return d.error("plugin "+b+" undefined"),this;return b.apply(this,arguments)}});d.extend(d.easing,{easeInOutCubic:function(b,a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a+c:d/2*((a-=2)*a*a+2)+c},easeInOutQuart:function(b,a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a*a+c:-d/2*((a-=2)*a*a*a-2)+c},easeInOutQuint:function(b,a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a*a*a+c:d/2*((a-=2)*a*a*a*a+2)+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c}})})(jQuery,window,document);
