define("tips",[],function(){function e(e,t){return this.each(function(){var i=$(this),n='<div class="tips_layer" style="position: absolute; border-radius:5px; background-color:#ff6600; display:none; z-index:995">                    <div class="tips-text" style="padding:2px 5px; line-height:18px; color:#fff;">'+e+'</div>                    <div class="diamond"></div>                </div>';$(".tips_layer")&&$(".tips_layer").remove(),$(n).appendTo("body");var a=($(".tips-text"),$(".tips_layer"));t?a.css({top:t.top,left:t.left}).show():a.css({top:i.offset().top-parseInt(i.height())-10,left:i.offset().left+parseInt(i.width()/2)-30}).show(),setTimeout(function(){a.remove()},2e3)})}function t(e,t){var i=$(this);return this.each(function(){var t='<div class="tips-base-layer" style="position: absolute; padding:5px 7px 7px 7px; font-size:14px; color:#fff; border-radius:5px; background-color:#000; opacity:0.8; display:none; z-index:995"><img style="position: relative; top:-1px;" src="//kaluli.hoopchina.com.cn/images/kaluli/order/oder-in.png" /> '+e+'<div style="position: absolute; right:45%; top:32px;"><img src="//kaluli.hoopchina.com.cn/images/kaluli/order/oder-in2.png" /></div></div>';$(".tips-base-layer")&&$(".tips-base-layer").remove(),$(t).appendTo("body"),$(".tips-base-layer").css({top:i.offset().top-parseInt($(".tips-base-layer").height())-20,left:i.offset().left-(i.width()>$(".tips-base-layer").width()?(i.width()-$(".tips-base-layer").width())/2:($(".tips-base-layer").width()-i.width())/2)}).show(),setTimeout(function(){$(".tips-base-layer").remove()},2e3)})}$.fn.tipsFun=t,function(){$.fn.tips=e,$.Jui=$.Jui||{},$.extend($.Jui,{_$:function(e,t){e.siblings().removeClass(t),e.addClass(t)},_showMasks:function(e){var t="<div class='body-mask' style='position:absolute; top:0; left:0; width:100%; height:"+$(document).height()+"px; background-color:#000;  z-index:101;'></div>";$("body").append(t),$(".body-mask").css("opacity",0),$(".body-mask").animate({opacity:e?e:"0.8"})},_closeMasks:function(){var e=$(".body-mask");e.fadeOut(function(){e.remove()})},_getpageSize:function(){var e,t=document.documentElement,i=window.innerWidth||self.innerWidth||t&&t.clientWidth||document.body.clientWidth,n=window.innerHeight||self.innerHeight||t&&t.clientHeight||document.body.clientHeight;return e=[i,n]},_position:function(e){var t=(this._getpageSize()[0]-parseInt(e.outerWidth()))/2,i=(this._getpageSize()[1]-parseInt(e.outerHeight()))/2+$.Jui._getpageScroll();return[t,i]},_getpageScroll:function(){var e;return self.pageYOffset?e=self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},isie:!!$.browser.msie,isie6:!!$.browser.msie&&parseInt($.browser.version)<=6,DOC:$(document),WIN:$(window),HEAD:$(document).find("head"),BODY:$(document).find("body")})}(jQuery)}),define("address",[],function(){var e={Verification:{name:!1,phone:!1,tell:!1,detailed:!1,postal:!1},init:function(e){this.bindFun(),this.cityAdd()},bindFun:function(){function e(){var e=$("input[name='phonesection']").data("check"),t=$("input[name='phonecode']").data("check"),i=$("input[name='phoneext']").data("check");e&&t?0==i?s.Verification.tell=!1:s.Verification.tell=!0:s.Verification.tell=!1}var t=/^1[34578][0-9]{9}$/,i=/^[0-9]{3,6}$/,n=/^[0-9]{5,10}$/,a=/^[0-9]{0,5}$/,s=this,d=!1;$("input[name='name']").blur(function(){var e=$(this).val();""==$.trim(e)?($(this).tips("请填写姓名",{left:$(this).offset().left+$(this).outerWidth()+10,top:$(this).offset().top}),s.Verification.name=!1,d=!0):(s.Verification.name=!0,d=!1)}),$("input[name='card']").blur(function(){var e=$(this).val(),t=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;e.length>1&&t.test(e)===!1?($(this).tips("请填写正确的身份证",{left:$(this).offset().left+$(this).outerWidth()+10,top:$(this).offset().top}),d=!0,s.Verification.card=!1):(s.Verification.card=!0,d=!1)}),$("input[name='phone']").blur(function(){var e=$(this).val();t.test(e)?(s.Verification.phone=!0,d=!1):($(this).tips("请填写正确的手机号码",{left:$(this).offset().left+$(this).outerWidth()+10,top:$(this).offset().top}),d=!0,s.Verification.phone=!1)}),$("input[name='phonesection']").blur(function(){var t=$(this).val();i.test(t)||""==$.trim(t)?($(this).data("check",!0),d=!1):($(this).tips("区号必须为3到6位数字",{left:$(this).offset().left+$(this).outerWidth()+10,top:$(this).offset().top}),$(this).data("check",!1),d=!0),e()}),$("input[name='phonecode']").blur(function(){var t=$(this).val();n.test(t)||""==$.trim(t)?($(this).data("check",!0),d=!1):($(this).tips("电话必须为5到10位数字",{left:$(this).offset().left+$(this).outerWidth()+10,top:$(this).offset().top}),$(this).data("check",!1),d=!0),e()}),$("input[name='phoneext']").blur(function(){var t=$(this).val();a.test(t)||""==$.trim(t)?($(this).data("check",!0),d=!1):($(this).tips("电话分机必须少于6个数字",{left:$(this).offset().left+$(this).outerWidth()+10,top:$(this).offset().top}),$(this).data("check",!1),d=!0),e()}),$("input[name='detailed']").blur(function(){var e=$(this).val();""==$.trim(e)?($(this).tips("请填写详细地址",{left:$(this).offset().left+$(this).outerWidth()+10,top:$(this).offset().top}),d=!0,s.Verification.detailed=!1):(s.Verification.detailed=!0,d=!1)}),$("input[name='address']").change(function(e){priceValue.address_id=1*$(this).val(),getPrice.getJson()}),$(".address-editor").find(".save").click(function(e){$(".address-editor").find("input[type=text]").trigger("blur");var t=$(this),i=t.parent().attr("data-value"),n=$("input[name='name']").val(),a=$("input[name=card]").val(),d=$("input[name='phone']").val(),o=$("input[name='phonesection']").val(),l=$("input[name='phonecode']").val(),r=$("input[name='phoneext']").val(),c=$(".sel-1").val(),u=$(".sel-2").val(),f=$(".sel-3").val(),p=$("input[name='detailed']").val(),h="000000";if("checked"==$("input[name='defaultflag']").attr("checked")?defaultflagVal=1:defaultflagVal=0,!s.Verification.name)return $("input[name='name']").blur(),!1;if(!s.Verification.card)return $("input[name='card']").blur(),!1;if(!s.Verification.phone)return $("input[name='phone']").blur(),!1;if(""!=$.trim($("input[name='phonesection']").val())&&""!=$.trim($("input[name='phonecode']").val())&&""!=$.trim($("input[name='phoneext']").val())&&!s.Verification.tell)return $("input[name='phonecode']").tips("请正确填写电话号码",{left:$("input[name='phonecode']").offset().left+$(this).outerWidth()+10,top:$("input[name='phonecode']").offset().top}),!1;if(!s.Verification.detailed)return $("input[name='detailed']").blur(),!1;var m={id:i,identity_number:a,name:n,mobile:d,phonesection:o,phonecode:l,phoneext:r,province:c,city:u,area:f,street:p,postcode:h,defaultflag:defaultflagVal};return"请选择"==c||"请选择"==u||"请选择"==f?($(".sel-3").tips("请选择地区",{left:$(".sel-3").offset().left+$(".sel-3").outerWidth()+10,top:$(".sel-3").offset().top}),!1):void $.post("//www.kaluli.com/api/editAddress",{address:m},function(e){if(-1*e.code==10)$.each(e.data.data,function(e,i){t.tips(i)});else{var n,a=1,d=$(".sel-1").find("option:selected").text(),o=$(".sel-2").find("option:selected").text(),l=$(".sel-3").find("option:selected").text();uw=m.identity_number.replace(/(\w)/g,function(e,t,i,n){return i>5&&i<12?"*":e}),1==m.defaultflag?($(".user-detail tbody .td6").text("否"),n="是"):n="否",a=""!=i?1:0;var r,c,u;if(c=""!=m.phonesection?"-":"",u=""!=m.phoneext?"-":"",1!=a&&(r="<tr data-value="+e.data.data.id+">"),r+='<td class="td1">'+m.name+"</td>",r+='<td class="td2">'+d+"&nbsp;"+o+"&nbsp;"+l+"&nbsp;"+m.street+"</td>",r+='<td class="td4">'+m.mobile+"<br />"+m.phonesection+c+m.phonecode+u+m.phoneext+"</td>",r+='<td class="td5">'+uw+"</td>",r+='<td class="td6">'+n+"</td>",r+='<td class="td7"><span class="editor">修改</span>|<span class="delete">删除</span>|<span class="defaultflag">设为默认</span></td>',1!=a&&(r+="</tr>"),""!=i){var f=$(".address-editor").attr("data-index");$(".user-detail tbody tr:eq("+f+")").html(r)}else $(".user-detail tbody").prepend(r);s.clearAddress(),s.callback()}},"json")}),$(".add_new_address").change(function(){$(".address-ul").show()})},callback:function(){},clearAddress:function(){$("input[name='name']").val(""),$("input[name='card']").val(""),$("input[name='phone']").val(""),$("input[name='phonesection']").val(""),$("input[name='phonecode']").val(""),$("input[name='phoneext']").val(""),$("input[name='detailed']").val(""),$("input[name='postal']").val(""),$("input[name='defaultflag']").removeAttr("checked"),$(".sel-1").val("请选择"),$(".sel-2").html("<option>请选择</option>"),$(".sel-3").html("<option>请选择</option>"),$(".address-editor").attr({"data-value":"","data-index":""})},cityAdd:function(){var e=$(".select_city"),t=this;e.find(".sel-1").change(function(e){var i=$(this).val();return $(".select_city").find(".sel-2").html('<option value="0">请选择</option>'),$(".select_city").find(".sel-3").html('<option value="0">请选择</option>'),"请选择"!=i&&void $.get("//www.kaluli.com/api/getNextRegionById?id="+i,function(e){t.cityAddstr(e,$(".select_city").find(".sel-2"))},"json")}),e.find(".sel-2").change(function(e){var i=$(this).val();return"请选择"!=i&&void $.get("//www.kaluli.com/api/getNextRegionById?id="+i,function(e){t.cityAddstr(e,$(".select_city").find(".sel-3"))},"json")})},cityAddstr:function(e,t){for(var i=["<option>请选择</option>"],n=0,a=e.data.list.length;n<a;n++)i.push('<option value="'+e.data.list[n].region_id+'">'+e.data.list[n].region_name+"</option>"),i.join("");t.html(i)}};return e}),define("chooseAddress",["address"],function(e){function t(){}return t.prototype={defaults:{wrap:".user-detail",ele:".user-detail tbody tr",checkon:"icon-check-nosprite",newAddressBtn:"newAddress",editaddress:".address-editor",editorBtn:".editor",deleteBtn:".delete",province:".sel-1",city:".sel-2",area:".sel-3",defaultflag:".defaultflag",success:0},init:function(){var t=this;e.callback=function(){t.deleteAddress(),t.editnewAddress(),t.defaultAddress()},e.init(),t.deleteAddress(),t.editnewAddress(),t.defaultAddress()},selectAddress:function(){function e(e){var t=$(e);t.find("i").hasClass(n.defaults.checkon)?(t.find("i").removeClass(n.defaults.checkon),$(n.defaults.editaddress).hide()):($(n.defaults.ele).find("i").removeClass(n.defaults.checkon),t.find("i").addClass(n.defaults.checkon),$(n.defaults.editaddress).attr("data-value",""),$(n.defaults.editaddress).show()),orderConfirm.clearAddress()}function t(e){var t=$(e);t.hasClass(n.defaults.checkon)&&t.siblings("span")||($(n.defaults.ele).find("i").removeClass(n.defaults.checkon),t.addClass(n.defaults.checkon)),t.parent().hasClass("newAddress")||$(n.defaults.editaddress).hide()}function i(i){var a=$(i);1==n.defaults.success&&($("."+n.defaults.newAddressBtn).unbind("click"),a.find("i").unbind("click")),a.hasClass(n.defaults.newAddressBtn)?$("."+n.defaults.newAddressBtn).bind("click",function(){e(this)}):(a.find("i").click(function(){t(this),getPrice.getJson()}),a.find("p").click(function(){a.find("i").trigger("click")}))}var n=this,a=$(n.defaults.wrap).find("li").length-1;$(n.defaults.wrap).find("li").each(function(e){i(this),a==e&&(n.defaults.success=1)})},editnewAddress:function(){var t=this,i="//www.kaluli.com/api/getAddress";$(t.defaults.ele).each(function(){var n=$(this),a=n.data("value");$(this).find(t.defaults.editorBtn).click(function(){e.clearAddress();var s=n.index();$(t.defaults.ele).find("i").removeClass(t.defaults.checkon),n.find("i").addClass(t.defaults.checkon),$.post(i,{id:a},function(e){var i=$.parseJSON(e).data,n={name:i.name,card:i.identity_number,phone:i.mobile,phonesection:i.phonesection,phoneext:i.phoneext,phonecode:i.phonecode,province:i.province,city:i.city,area:i.area,detailed:i.street,postal:i.postcode};for(var d in n)$("input[name="+d+"]").val(n[d]);1==i.defaultflag&&$("input[name=defaultflag]").attr("checked","checked");var o=$("option[value="+n.province+"]",t.defaults.province).index();$(t.defaults.province)[0].selectedIndex=o,$.get("//www.kaluli.com/api/getNextRegionById?id="+n.province,function(e){t.cityAddstr(e,$(".select_city").find(".sel-2"));var i=$("option[value="+n.city+"]",t.defaults.city).index();$(t.defaults.city)[0].selectedIndex=i,$.get("//www.kaluli.com/api/getNextRegionById?id="+n.city,function(e){t.cityAddstr(e,$(".select_city").find(".sel-3"));var i=$("option[value="+n.area+"]",t.defaults.area).index();$(t.defaults.area)[0].selectedIndex=i},"json")},"json"),$(t.defaults.editaddress).attr({"data-value":a,"data-index":s}).show()})})})},cityAddstr:function(e,t){for(var i=[],n=0,a=e.data.list.length;n<a;n++)i.push('<option value="'+e.data.list[n].region_id+'">'+e.data.list[n].region_name+"</option>"),i.join("");t.append(i)},defaultAddress:function(){var e=this;$(e.defaults.defaultflag).click(function(){var e=$(this).parents("tr"),t=e.attr("data-value");$.post("//www.kaluli.com/api/setDefaultAddress",{id:t},function(t){$(".user-detail tbody .td6").text("否"),e.find(".td6").text("是")})})},deleteAddress:function(){var e=this,t="//www.kaluli.com/api/delAddress";$(e.defaults.ele).each(function(){var i=$(this),n=i.data("value");$(this).find(e.defaults.deleteBtn).click(function(){$.post(t,{id:n},function(e){i.remove()})})})}},t}),requirejs.config({baseUrl:"/js/kaluli/",paths:{tips:"modules/common/tips",address:"modules/ucenter/address",chooseAddress:"modules/ucenter/chooseAddress"}}),require(["tips","chooseAddress"],function(e,t){$(".prolist").length>0&&$.post("//www.kaluli.com/api/getHotItem",function(e){$(".prolist").html(e)}),$(".refresh").click(function(){$.post("//www.kaluli.com/api/getHotItem",function(e){$(".prolist").html(e)})});var i=new t;i.init()}),define("app/ucenterIndex",function(){});