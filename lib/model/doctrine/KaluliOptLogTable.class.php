<?php

/**
 * KaluliOptLogTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class KaluliOptLogTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object KaluliOptLogTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('KaluliOptLog');
    }
    //插入操作
    public  function insertOptLogForLook($optID, $uid, $optJson, $optURI){
        $kaLuLiLiPinKaOptLog = new KaluliOptLog();
        $kaLuLiLiPinKaOptLog->setOptId($optID);
        $kaLuLiLiPinKaOptLog->setOptTime(time());
        $kaLuLiLiPinKaOptLog->setOptUid($uid);
        $kaLuLiLiPinKaOptLog->setOptJson($optJson);
        $kaLuLiLiPinKaOptLog->setOptUri($optURI);
        $kaLuLiLiPinKaOptLog->save();
    }
    //查询数据
    public static function  getAll($bind = array()) {

        $data = self::getInstance()->createQuery();
        //select
        if (!empty($bind['select'])){
            $data->select($bind['select']);
        } else {
            $data->select("*");
        }
        //where 简单判断  如果复杂 建议新写函数
        if(!empty($bind['where']) && count($bind['where']) > 0) {
            foreach($bind['where'] as $k=>$v) {
                $data->addWhere($v);
            }
        }
        //order
        if (!empty($bind['order'])){
            $data->orderBy($bind['order']);
        } else {
            $data->orderBy('id desc');
        }

        //limit
        if (!empty($bind['limit'])){
            $data->limit($bind['limit']);
        }

        if(!empty($bind['offset'])) {
            $data->offset($bind['offset']);
        }
        $data =  $data->fetchArray();
        if(!empty($bind['is_count'])) {
            $data = $data[0]['num'];
        }
        return $data;
    }
    //获得单条数据
    public static function getLogByOne($id){
        return self::getInstance()->createQuery()->andWhere('id = ?', $id)->fetchArray();
    }
    //清空表
    static function tableClear(){
        $data = self::getInstance()->createQuery()->execute();
        return $data->delete();
    }
}