<?php

/**
 * KllBBOrderTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class KllBBOrderTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object KllBBOrderTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('KllBBOrder');
    }
     /**
     * 获得子订单
     * @param $status
     */
    public static function getAllOrder($order_number) {
        $data = self::getInstance()->createQuery();
        $data->select("name, description, number as quantity, total_price as amount, receiver")
             ->where("order_number = ?",$order_number);
        $order = $data->fetchArray();
        if(!empty($order)){
            foreach ($order as $key => &$it) {
                $it['amount'] = (string)($it['amount'] * 100);
            }
        }
        return $order;
    }
    public static function getOne($id,$is_toarray = true,$field = '') {
        $info = self::getInstance()
            ->createQuery()
            ->select('*')
            ->andWhere('id = ?',$id)
            ->fetchOne();
        if(empty($info)) return false;
        if(empty($is_toarray)) return $info;
        $info = $info->toArray();
        if(empty($field)) return $info;
        return $info[$field];
    }
    public static function  getOrdersByOrderNubmer($order_number) {
        $info = self::getInstance()
            ->createQuery()
            ->select('*')
            ->andWhere('order_number = ?',$order_number)
            ->fetchArray();
        if(empty($info)) return false;
        return $info;
    }
    public  function  getOrdersByOrderNubmerForBB($order_number) {
        $info = self::getInstance()
            ->createQuery()
            ->select('*')
            ->andWhere('order_number = ?',$order_number)
            ->fetchArray();
        if(empty($info)) return false;
        return $info;
    }
}