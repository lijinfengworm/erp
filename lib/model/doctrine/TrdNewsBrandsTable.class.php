<?php

/**
 * TrdNewsBrandsTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class TrdNewsBrandsTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object TrdNewsBrandsTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('TrdNewsBrands');
    }


    /**
     * 添加新的品牌
     */
    public static function createBrand($brand_name) {
        if(empty($brand_name)) return false;
        //先查询有没有
        $find =   self::getInstance()->createQuery()->select('id')->andWhere('brand_name = ?',$brand_name)->fetchOne();
        if(!empty($find)) return $find['id'];
        $content        =   new TrdNewsBrands();
        $contentData    =   array(
            'brand_name'     =>  $brand_name,
            'brands_status'   =>  1,
        );
        $content->fromArray($contentData);
        $content->save();
        return $content->getId();
    }



    /**
     * 通过name 搜索品牌
     */
    public static function getByNameBrands($_name,$num = 16) {
        $query = self::getInstance()
            ->createQuery()
            ->select('id,brand_name')
            ->andWhere('brand_name like "%'.$_name.'%"')
            ->limit($num)
            ->fetchArray();
       if(empty($query)) return false;
        return $query;
    }



    /**
     * 通过IDs 搜索品牌
     */
    public static function getByIds(array $ids) {

        $query = self::getInstance()
            ->createQuery()
            ->select('id,brand_name')
            ->WhereIn('id ',$ids)
            ->orderBy("FIELD(`id`,".trim(join(",", $ids)) .")")
            ->fetchArray();
        if(empty($query)) return false;
        return $query;
    }






}