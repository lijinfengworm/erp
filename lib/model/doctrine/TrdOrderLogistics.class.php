<?php

/**
 * TrdOrderLogistics
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    HC
 * @subpackage model
 * @author     HoopChina.com Dev Team
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class TrdOrderLogistics extends BaseTrdOrderLogistics
{
    public function save(Doctrine_Connection $conn = null) 
    {
        $modifiedFields = $this->getModified(true);
        parent::save($conn);
        //笨鸟分拣指令
        $syncAskKeyArray =array('foreign_status');
        if(!$this->isNew() && array_intersect($syncAskKeyArray,array_keys($modifiedFields)))
        {
            if($this->getForeignStatus() == 1 && $this->getType() == 2){
                $content = json_decode($this->getContent(), true);
                $tradeBirdexService = new tradeBirdexService();
                $tradeBirdexService->sortingPackage($this->getExpressNumber(), false, $content);
            }
        }
        return $this->getId();
        
    }
}
