<?php

/**
 * trdCommentProhibitTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class trdCommentProhibitTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object trdCommentProhibitTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('trdCommentProhibit');
    }

    /*
     *封禁
     *
     **/
    public static function saveProhibit($type,$type_num,$allow_date){
        $return = array();
        try{
            $commentProhibit = trdCommentProhibitTable::getInstance()->createQuery()->where('type = ?',$type)->andWhere('type_num = ?',$type_num)->fetchOne();
            if(!$commentProhibit) $commentProhibit = new trdCommentProhibit();

            $commentProhibit->setType($type);
            $commentProhibit->setTypeNum($type_num);
            $commentProhibit->setAllowDate($allow_date);
            $commentProhibit->save();

            if($commentProhibit->getId()){
                $return['status'] = true;
                $return['msg'] = '封禁成功';
            }else{
                throw new Exception('服务器出错,请稍后再试',500);
            }
        }catch(Exception $e) {
            $return['status'] = false;
            $return['msg'] =  $e->getMessage();
        }

        return $return;
    }

}