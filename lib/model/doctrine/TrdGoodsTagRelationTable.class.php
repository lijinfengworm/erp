<?php

/**
 * TrdGoodsTagRelationTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class TrdGoodsTagRelationTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object TrdGoodsTagRelationTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('TrdGoodsTagRelation');
    }

    public static function getGoodsTags($goodsId)
    {
        $connection = Doctrine_Manager::getInstance()->getConnection('trade');

        $query = "select b.name,a.group_id from trd_goods_tag_relation as a join trd_goods_tag as b on a.tag_id=b.id where a.goods_id='{$goodsId}'";
        $statement = $connection->execute($query);
        $statement->execute();
        $resultset = $statement->fetchAll(PDO::FETCH_ASSOC);
        return $resultset;
    }
}