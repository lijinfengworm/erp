<?php

/**
 * TrdGrouponCategoryTable
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class TrdGrouponCategoryTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object TrdGrouponCategoryTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('TrdGrouponCategory');
    }
    
    public static function getAllCategory(){
        $query =  self::getInstance()->createQuery('a')
            ->select('*')
            ->orderby("a.sort asc,id desc");
            return $query ->execute();
    }

    public static function getAllCategoryName(){
        $allName = array();
        $obj =  self::getInstance()->createQuery('a')
            ->setResultCacheHash('trade:memcache:groupon:category:all:name')
            ->setResultCacheLifeSpan( 60*10 )
            ->useResultCache()
            ->select('*')
            ->orderby("sort desc")
            ->execute();
        foreach($obj as $k=>$v){
            $allName[$v->getId()] =  $v->getName();
        }
        return $allName;
    }

    public static function getAllNormarlCategory(){
        $query =  self::getInstance()->createQuery('a')
            ->select('*')
            ->where("is_delete = 0")
            ->orderby("a.sort asc,id desc");
        return $query ->execute();
    }

    public function getSomeById($ids)
    {
       
        $category_info = self::getInstance()->createQuery()->whereIn('id',$ids)->execute();
        $result = array();
        foreach($category_info as $category)
        {
            $result[$category->getId()] = $category;
        }
        return $result;
    }

    static public function getCategoryName($id)
    {
        if($id){
            return self::getInstance()->createQuery()->where('id = ?',$id)->fetchOne()->getName();
        }else{
            return '';
        }
    }
}