<?php

/**
 * TrdHaitaoCurrencyExchangeTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class TrdHaitaoCurrencyExchangeTable extends Doctrine_Table {

    /**
     * Returns an instance of this class.
     *
     * @return object TrdHaitaoCurrencyExchangeTable
     */
    public static function getInstance() {
        return Doctrine_Core::getTable('TrdHaitaoCurrencyExchange');
    }

    //取汇率
    public static function getRate($type = 'usd'){
        if ($type == 'usd') {//美元
            $return = self::getInstance()->createQuery()->select('exchange_rate')->where('currency_from = ?',0)->andWhere('currency_to = ?',1)->limit(1)->fetchOne();
            if ($return) {
                return $return->getExchangeRate();
            }
        } elseif ($type == 'jpy') {//日元
            $return = self::getInstance()->createQuery()->select('exchange_rate')->where('currency_from = ?',1)->andWhere('currency_to = ?',4)->limit(1)->fetchOne();
            if ($return) {
                $rate = $return->getExchangeRate();
                return ceil((1/$rate)*10000)/10000;
            }
        } elseif ($type == 'rmb') {//人民币
            return 1;
        }else {
            return 6.3;
        }
        return 6.3;
    }

}
