<?php

/**
 * TrdSeoNewsTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class TrdSeoNewsTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object TrdSeoNewsTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('TrdSeoNews');
    }

    /*
  * 删除单条内容
  */
    public static function deleteMessage($id=0,$msg_source='',$list_page=0) {
        $res = self::getInstance()->find($id);
        $res->setIsDelete(1);
        $res->save();

        return true;
    }

    public static function myListQuery() {
        $query = self::getInstance()->createQuery('m')
            ->where('m.is_delete = 0')
            ->orderBy('m.created_at desc');
        return $query;
    }

    /*分页获取信息*/
    public static function getInfoByPage($type,$page,$pageSize){
       return $query =  self::getInstance()->createQuery('t')
                 ->where('t.is_delete = 0')
                 ->andWhere('t.publish_date <= ?',date('Y-m-d H:i:s',time()))
                 ->andWhere('t.type = ?',$type)
                 ->offset(($page-1)*$pageSize)
                 ->limit($pageSize)
                 ->orderBy('t.publish_date desc, t.id desc')
                 ->execute();

    }
}