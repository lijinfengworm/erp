<?php

/**
 * TrdFindStore
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    HC
 * @subpackage model
 * @author     HoopChina.com Dev Team
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class TrdFindStore extends BaseTrdFindStore {

    public function display($isShow) {
        if ($isShow) {
            $v = 1;
        } else {
            $v = 0;
        }
        $this->setIsDisplay($v);
        $this->save();
        return true;
    }

    public function save(Doctrine_Connection $conn = null) {
        if ($this->isNew()) {
            $sort = $this->getSort();
            $q = Doctrine_Core::getTable('TrdFindStore')
                    ->createQuery('j')
                    ->where('j.sort = ?', $sort);
            if ($q->count()) {
                sfContext::getInstance()->getUser()->setFlash('notice', '您设置的item中的排序已经存在，请重新设置。');
                sfContext::getInstance()->getController()->redirect('trd_find_store');
                exit;
            } else {
                parent::save($conn);
            }
        } else {
            parent::save($conn);
        }
    }

}
